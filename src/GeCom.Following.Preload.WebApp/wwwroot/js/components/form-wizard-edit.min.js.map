{"version":3,"file":"form-wizard-edit.min.js","names":["validateFirstTabFields","form","document","getElementById","isValid","querySelectorAll","forEach","input","offsetParent","disabled","tagName","$","data","value","val","classList","remove","add","id","digitsOnly","replace","trim","length","nextElementSibling","contains","textContent","flatpickrInput","querySelector","_flatpickr","altInput","dateValue","dateValid","selectedDates","fechaFacturaDate","today","Date","setHours","setCustomValidity","fechaFacturaInput","vencCaecaiDate","type","parseFloat","updateTabsState","wizardElement","isPendingPreload","navLinks","i","style","pointerEvents","opacity","cursor","updateWarningAlertVisibility","warningAlert","display","validateCaecaiField","hasAttribute","feedback","validatePuntoDeVentaField","validateNumeroComprobanteField","validateField","checkValidity","setupFormValidation","getInitialState","on","selectElement","this","setTimeout","updateTabRestrictionsOnChange","addEventListener","e","substring","char","String","fromCharCode","which","test","preventDefault","config","onChange","push","vencInput","set","$select","initialState","hasChanges","hasFormChanged","tabLinks","link","index","showValidationToast","dotNetReference","message","invokeMethodAsync","catch","error","console","alert","getFormData","formData","fieldId","name","date","year","getFullYear","month","getMonth","padStart","day","getDate","docId","sociedadCuit","tipoDocId","parseInt","puntoDeVenta","numeroComprobante","fechaEmisionComprobante","moneda","montoBruto","caecai","vencimientoCaecai","saveInitialFormState","inputs","hasOwnProperty","initialValue","toString","setupNavigationRestrictions","updateInitialState","validationMessage","changeMessage","isNavigatingFromNextButton","stopPropagation","stopImmediatePropagation","nextButton","async","activeTab","activeTabHref","getAttribute","confirmed","confirm","result","success","updatedState","currentTabIndex","Array","from","indexOf","nextTabLink","bootstrap","Tab","show","target","updateSaveButtonVisibility","saveButtonContainer","setupSaveButtonVisibility","window","initEditDocumentWizard","initialStateContainer","newState","initWizard","warn","Wizard","setAttribute","validate","log","attempts","interval","setInterval","clearInterval","resetEditDocumentWizard","firstTab","firstTabPane","pane"],"sources":["form-wizard-edit.js"],"mappings":"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","ignoreList":[],"sourcesContent":["/**\r\n * Theme: Adminto - Responsive Bootstrap 5 Admin Dashboard\r\n * Author: Coderthemes\r\n * Module/App: Form Wizard with Validation for Edit Document Modal\r\n */\r\n\r\n/**\r\n * Validates all required fields in the first tab of the document properties form\r\n * @returns {boolean} True if all required fields are valid, false otherwise\r\n */\r\nfunction validateFirstTabFields() {\r\n    var form = document.getElementById('documentPropertiesForm');\r\n    if (!form) return false;\r\n\r\n    var isValid = true;\r\n    var requiredInputs = form.querySelectorAll('input[required], select[required]');\r\n\r\n    requiredInputs.forEach(function (input) {\r\n        // Skip validation for hidden or disabled fields\r\n        if (input.offsetParent === null || input.disabled) {\r\n            return;\r\n        }\r\n\r\n        // For SELECT2 selects, get value from SELECT2\r\n        if (input.tagName === 'SELECT' && typeof $ !== 'undefined' && $(input).data('select2')) {\r\n            var value = $(input).val();\r\n            if (!value || value === '' || value === null) {\r\n                isValid = false;\r\n                input.classList.add('is-invalid');\r\n                input.classList.remove('is-valid');\r\n            } else {\r\n                input.classList.remove('is-invalid');\r\n                input.classList.add('is-valid');\r\n            }\r\n        } else {\r\n            // For regular inputs\r\n            var value = input.value;\r\n            \r\n            // Special validation for CAE/CAI field - must have exactly 14 digits\r\n            if (input.id === 'caecai-edit') {\r\n                // Remove non-digit characters for validation\r\n                var digitsOnly = value.replace(/\\D/g, '');\r\n                if (!value || value.trim() === '' || digitsOnly.length !== 14) {\r\n                    isValid = false;\r\n                    input.classList.add('is-invalid');\r\n                    input.classList.remove('is-valid');\r\n                    if (input.nextElementSibling && input.nextElementSibling.classList.contains('invalid-feedback')) {\r\n                        input.nextElementSibling.textContent = 'El nro. CAE/CAI debe tener exactamente 14 dígitos.';\r\n                    }\r\n                } else {\r\n                    input.classList.remove('is-invalid');\r\n                    input.classList.add('is-valid');\r\n                }\r\n            }\r\n            // Special validation for Punto de Venta field - must have maximum 5 digits\r\n            else if (input.id === 'punto-venta-edit') {\r\n                // Remove non-digit characters for validation\r\n                var digitsOnly = value.replace(/\\D/g, '');\r\n                if (!value || value.trim() === '' || digitsOnly.length === 0) {\r\n                    isValid = false;\r\n                    input.classList.add('is-invalid');\r\n                    input.classList.remove('is-valid');\r\n                    if (input.nextElementSibling && input.nextElementSibling.classList.contains('invalid-feedback')) {\r\n                        input.nextElementSibling.textContent = 'Por favor ingrese el punto de venta.';\r\n                    }\r\n                } else if (digitsOnly.length > 5) {\r\n                    isValid = false;\r\n                    input.classList.add('is-invalid');\r\n                    input.classList.remove('is-valid');\r\n                    if (input.nextElementSibling && input.nextElementSibling.classList.contains('invalid-feedback')) {\r\n                        input.nextElementSibling.textContent = 'El punto de venta no debe tener más de 5 dígitos.';\r\n                    }\r\n                } else {\r\n                    input.classList.remove('is-invalid');\r\n                    input.classList.add('is-valid');\r\n                }\r\n            }\r\n            // Special validation for Número de Comprobante field - must have maximum 8 digits\r\n            else if (input.id === 'numero-comprobante-edit') {\r\n                // Remove non-digit characters for validation\r\n                var digitsOnly = value.replace(/\\D/g, '');\r\n                if (!value || value.trim() === '' || digitsOnly.length === 0) {\r\n                    isValid = false;\r\n                    input.classList.add('is-invalid');\r\n                    input.classList.remove('is-valid');\r\n                    if (input.nextElementSibling && input.nextElementSibling.classList.contains('invalid-feedback')) {\r\n                        input.nextElementSibling.textContent = 'Por favor ingrese el número de comprobante.';\r\n                    }\r\n                } else if (digitsOnly.length > 8) {\r\n                    isValid = false;\r\n                    input.classList.add('is-invalid');\r\n                    input.classList.remove('is-valid');\r\n                    if (input.nextElementSibling && input.nextElementSibling.classList.contains('invalid-feedback')) {\r\n                        input.nextElementSibling.textContent = 'El número de comprobante no debe tener más de 8 dígitos.';\r\n                    }\r\n                } else {\r\n                    input.classList.remove('is-invalid');\r\n                    input.classList.add('is-valid');\r\n                }\r\n            }\r\n            // Special validation for date fields using Flatpickr\r\n            else if (input.id === 'fecha-factura-edit' || input.id === 'venc-caecai-edit') {\r\n                // Check if Flatpickr instance exists\r\n                var flatpickrInput = input.id === 'fecha-factura-edit' \r\n                    ? document.querySelector('#fecha-factura-edit')\r\n                    : document.querySelector('#venc-caecai-edit');\r\n                \r\n                if (flatpickrInput && flatpickrInput._flatpickr) {\r\n                    var altInput = flatpickrInput._flatpickr.altInput;\r\n                    if (altInput) {\r\n                        var dateValue = altInput.value;\r\n                        if (!dateValue || dateValue.trim() === '') {\r\n                            isValid = false;\r\n                            altInput.classList.add('is-invalid');\r\n                            altInput.classList.remove('is-valid');\r\n                        } else {\r\n                            // Validate date constraints\r\n                            var dateValid = true;\r\n                            \r\n                            // Validate fecha factura - cannot be greater than today\r\n                            if (input.id === 'fecha-factura-edit') {\r\n                                if (flatpickrInput._flatpickr.selectedDates.length > 0) {\r\n                                    var fechaFacturaDate = flatpickrInput._flatpickr.selectedDates[0];\r\n                                    var today = new Date();\r\n                                    today.setHours(0, 0, 0, 0);\r\n                                    fechaFacturaDate.setHours(0, 0, 0, 0);\r\n                                    if (fechaFacturaDate > today) {\r\n                                        dateValid = false;\r\n                                        altInput.setCustomValidity('La fecha de factura no puede ser mayor al día actual.');\r\n                                    } else {\r\n                                        altInput.setCustomValidity('');\r\n                                    }\r\n                                }\r\n                            }\r\n                            \r\n                            // Validate vencimiento CAE/CAI - cannot be before fecha factura\r\n                            if (input.id === 'venc-caecai-edit') {\r\n                                var fechaFacturaInput = document.querySelector('#fecha-factura-edit');\r\n                                if (fechaFacturaInput && fechaFacturaInput._flatpickr && fechaFacturaInput._flatpickr.selectedDates.length > 0) {\r\n                                    var fechaFacturaDate = fechaFacturaInput._flatpickr.selectedDates[0];\r\n                                    if (flatpickrInput._flatpickr.selectedDates.length > 0) {\r\n                                        var vencCaecaiDate = flatpickrInput._flatpickr.selectedDates[0];\r\n                                        fechaFacturaDate.setHours(0, 0, 0, 0);\r\n                                        vencCaecaiDate.setHours(0, 0, 0, 0);\r\n                                        if (vencCaecaiDate < fechaFacturaDate) {\r\n                                            dateValid = false;\r\n                                            altInput.setCustomValidity('La fecha Venc. CAE/CAI no puede ser anterior a la fecha de factura.');\r\n                                        } else {\r\n                                            altInput.setCustomValidity('');\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            \r\n                            if (!dateValid || altInput.classList.contains('is-invalid')) {\r\n                                isValid = false;\r\n                                altInput.classList.add('is-invalid');\r\n                                altInput.classList.remove('is-valid');\r\n                            } else {\r\n                                altInput.classList.remove('is-invalid');\r\n                                altInput.classList.add('is-valid');\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Fallback validation if Flatpickr is not initialized\r\n                    if (!value || value.trim() === '') {\r\n                        isValid = false;\r\n                        input.classList.add('is-invalid');\r\n                        input.classList.remove('is-valid');\r\n                    } else {\r\n                        input.classList.remove('is-invalid');\r\n                        input.classList.add('is-valid');\r\n                    }\r\n                }\r\n            }\r\n            else if (input.type === 'number') {\r\n                if (!value || value === '' || parseFloat(value) <= 0) {\r\n                    isValid = false;\r\n                    input.classList.add('is-invalid');\r\n                    input.classList.remove('is-valid');\r\n                } else {\r\n                    input.classList.remove('is-invalid');\r\n                    input.classList.add('is-valid');\r\n                }\r\n            } else {\r\n                if (!value || value.trim() === '') {\r\n                    isValid = false;\r\n                    input.classList.add('is-invalid');\r\n                    input.classList.remove('is-valid');\r\n                } else {\r\n                    input.classList.remove('is-invalid');\r\n                    input.classList.add('is-valid');\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    return isValid;\r\n}\r\n\r\n/**\r\n * Updates the state of tabs (enabled/disabled) based on validation\r\n * @param {HTMLElement} wizardElement - The wizard container element\r\n * @param {boolean} isPendingPreload - Whether the document is in \"Pendiente Precarga\" status\r\n */\r\nfunction updateTabsState(wizardElement, isPendingPreload) {\r\n    if (!isPendingPreload) return;\r\n\r\n    var isValid = validateFirstTabFields();\r\n    var navLinks = wizardElement.querySelectorAll('.nav-link');\r\n\r\n    for (var i = 1; i < navLinks.length; i++) {\r\n        if (isValid) {\r\n            navLinks[i].classList.remove('disabled');\r\n            navLinks[i].style.pointerEvents = '';\r\n            navLinks[i].style.opacity = '';\r\n            navLinks[i].style.cursor = '';\r\n        } else {\r\n            navLinks[i].classList.add('disabled');\r\n            navLinks[i].style.pointerEvents = 'none';\r\n            navLinks[i].style.opacity = '0.5';\r\n            navLinks[i].style.cursor = 'not-allowed';\r\n        }\r\n    }\r\n    \r\n    // Update warning alert visibility\r\n    updateWarningAlertVisibility(isValid);\r\n}\r\n\r\n/**\r\n * Updates the visibility of the first tab warning alert\r\n * @param {boolean} isValid - Whether all required fields are valid\r\n */\r\nfunction updateWarningAlertVisibility(isValid) {\r\n    var warningAlert = document.getElementById('first-tab-warning-alert');\r\n    if (warningAlert) {\r\n        if (isValid) {\r\n            // Hide the alert if all fields are valid\r\n            warningAlert.style.display = 'none';\r\n        } else {\r\n            // Show the alert if any field is invalid\r\n            warningAlert.style.display = 'block';\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Validates the CAE/CAI field - must have exactly 14 digits\r\n * @param {HTMLElement} input - The input element to validate\r\n * @returns {boolean} True if valid, false otherwise\r\n */\r\nfunction validateCaecaiField(input) {\r\n    if (!input || input.id !== 'caecai-edit') {\r\n        return true;\r\n    }\r\n\r\n    var value = input.value || '';\r\n    // Remove non-digit characters for validation\r\n    var digitsOnly = value.replace(/\\D/g, '');\r\n    \r\n    if (!value || value.trim() === '') {\r\n        if (input.hasAttribute('required')) {\r\n            input.setCustomValidity('Por favor ingrese el número de CAE / CAI.');\r\n            input.classList.add('is-invalid');\r\n            input.classList.remove('is-valid');\r\n            return false;\r\n        }\r\n        input.setCustomValidity('');\r\n        input.classList.remove('is-invalid');\r\n        input.classList.remove('is-valid');\r\n        return true;\r\n    }\r\n\r\n    if (digitsOnly.length !== 14) {\r\n        input.setCustomValidity('El nro. CAE/CAI debe tener exactamente 14 dígitos.');\r\n        input.classList.add('is-invalid');\r\n        input.classList.remove('is-valid');\r\n        // Update invalid-feedback message\r\n        var feedback = input.nextElementSibling;\r\n        if (feedback && feedback.classList.contains('invalid-feedback')) {\r\n            feedback.textContent = 'El nro. CAE/CAI debe tener exactamente 14 dígitos.';\r\n        }\r\n        return false;\r\n    }\r\n\r\n    input.setCustomValidity('');\r\n    input.classList.remove('is-invalid');\r\n    input.classList.add('is-valid');\r\n    return true;\r\n}\r\n\r\n/**\r\n * Validates the Punto de Venta field - must have maximum 5 digits\r\n * @param {HTMLElement} input - The input element to validate\r\n * @returns {boolean} True if valid, false otherwise\r\n */\r\nfunction validatePuntoDeVentaField(input) {\r\n    if (!input || input.id !== 'punto-venta-edit') {\r\n        return true;\r\n    }\r\n\r\n    var value = input.value || '';\r\n    // Remove non-digit characters for validation\r\n    var digitsOnly = value.replace(/\\D/g, '');\r\n    \r\n    if (!value || value.trim() === '' || digitsOnly.length === 0) {\r\n        if (input.hasAttribute('required')) {\r\n            input.setCustomValidity('Por favor ingrese el punto de venta.');\r\n            input.classList.add('is-invalid');\r\n            input.classList.remove('is-valid');\r\n            // Update invalid-feedback message\r\n            var feedback = input.nextElementSibling;\r\n            if (feedback && feedback.classList.contains('invalid-feedback')) {\r\n                feedback.textContent = 'Por favor ingrese el punto de venta.';\r\n            }\r\n            return false;\r\n        }\r\n        input.setCustomValidity('');\r\n        input.classList.remove('is-invalid');\r\n        input.classList.remove('is-valid');\r\n        return true;\r\n    }\r\n\r\n    if (digitsOnly.length > 5) {\r\n        input.setCustomValidity('El punto de venta no debe tener más de 5 dígitos.');\r\n        input.classList.add('is-invalid');\r\n        input.classList.remove('is-valid');\r\n        // Update invalid-feedback message\r\n        var feedback = input.nextElementSibling;\r\n        if (feedback && feedback.classList.contains('invalid-feedback')) {\r\n            feedback.textContent = 'El punto de venta no debe tener más de 5 dígitos.';\r\n        }\r\n        return false;\r\n    }\r\n\r\n    input.setCustomValidity('');\r\n    input.classList.remove('is-invalid');\r\n    input.classList.add('is-valid');\r\n    return true;\r\n}\r\n\r\n/**\r\n * Validates the Número de Comprobante field - must have maximum 8 digits\r\n * @param {HTMLElement} input - The input element to validate\r\n * @returns {boolean} True if valid, false otherwise\r\n */\r\nfunction validateNumeroComprobanteField(input) {\r\n    if (!input || input.id !== 'numero-comprobante-edit') {\r\n        return true;\r\n    }\r\n\r\n    var value = input.value || '';\r\n    // Remove non-digit characters for validation\r\n    var digitsOnly = value.replace(/\\D/g, '');\r\n    \r\n    if (!value || value.trim() === '' || digitsOnly.length === 0) {\r\n        if (input.hasAttribute('required')) {\r\n            input.setCustomValidity('Por favor ingrese el número de comprobante.');\r\n            input.classList.add('is-invalid');\r\n            input.classList.remove('is-valid');\r\n            // Update invalid-feedback message\r\n            var feedback = input.nextElementSibling;\r\n            if (feedback && feedback.classList.contains('invalid-feedback')) {\r\n                feedback.textContent = 'Por favor ingrese el número de comprobante.';\r\n            }\r\n            return false;\r\n        }\r\n        input.setCustomValidity('');\r\n        input.classList.remove('is-invalid');\r\n        input.classList.remove('is-valid');\r\n        return true;\r\n    }\r\n\r\n    if (digitsOnly.length > 8) {\r\n        input.setCustomValidity('El número de comprobante no debe tener más de 8 dígitos.');\r\n        input.classList.add('is-invalid');\r\n        input.classList.remove('is-valid');\r\n        // Update invalid-feedback message\r\n        var feedback = input.nextElementSibling;\r\n        if (feedback && feedback.classList.contains('invalid-feedback')) {\r\n            feedback.textContent = 'El número de comprobante no debe tener más de 8 dígitos.';\r\n        }\r\n        return false;\r\n    }\r\n\r\n    input.setCustomValidity('');\r\n    input.classList.remove('is-invalid');\r\n    input.classList.add('is-valid');\r\n    return true;\r\n}\r\n\r\n/**\r\n * Validates a single field\r\n * @param {HTMLElement} input - The input element to validate\r\n * @returns {boolean} True if valid, false otherwise\r\n */\r\nfunction validateField(input) {\r\n    // Special validation for CAE/CAI field\r\n    if (input.id === 'caecai-edit') {\r\n        return validateCaecaiField(input);\r\n    }\r\n    \r\n    // Special validation for Punto de Venta field\r\n    if (input.id === 'punto-venta-edit') {\r\n        return validatePuntoDeVentaField(input);\r\n    }\r\n    \r\n    // Special validation for Número de Comprobante field\r\n    if (input.id === 'numero-comprobante-edit') {\r\n        return validateNumeroComprobanteField(input);\r\n    }\r\n    \r\n    if (input.hasAttribute('required')) {\r\n        if (input.type === 'text' || input.type === 'number') {\r\n            if (!input.value || input.value.trim() === '') {\r\n                input.setCustomValidity('Este campo es obligatorio');\r\n                input.classList.add('is-invalid');\r\n                input.classList.remove('is-valid');\r\n                return false;\r\n            } else {\r\n                input.setCustomValidity('');\r\n                input.classList.remove('is-invalid');\r\n                if (input.checkValidity()) {\r\n                    input.classList.add('is-valid');\r\n                }\r\n                return true;\r\n            }\r\n        } else if (input.tagName === 'SELECT') {\r\n            if (!input.value || input.value === '') {\r\n                input.setCustomValidity('Por favor seleccione una opción');\r\n                input.classList.add('is-invalid');\r\n                input.classList.remove('is-valid');\r\n                return false;\r\n            } else {\r\n                input.setCustomValidity('');\r\n                input.classList.remove('is-invalid');\r\n                input.classList.add('is-valid');\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\n/**\r\n * Sets up validation listeners for form fields and change detection\r\n * @param {HTMLElement} form - The form element\r\n * @param {boolean} isPendingPreload - Whether the document is in \"Pendiente Precarga\" status\r\n * @param {HTMLElement} wizardElement - The wizard container element\r\n * @param {Function} getInitialState - Function that returns the initial state of form fields for change detection\r\n */\r\nfunction setupFormValidation(form, isPendingPreload, wizardElement, getInitialState) {\r\n    if (!form) return;\r\n\r\n    // Function to update tab restrictions based on form changes and validation\r\n    function updateTabRestrictionsOnChange() {\r\n        var initialState = getInitialState ? getInitialState() : null;\r\n        var isValid = validateFirstTabFields();\r\n        var hasChanges = initialState ? hasFormChanged(form, initialState) : false;\r\n        var tabLinks = wizardElement.querySelectorAll('.nav-link');\r\n        \r\n        // Block tabs if required fields are not valid (regardless of status or changes)\r\n        if (!isValid) {\r\n            tabLinks.forEach(function (link, index) {\r\n                if (index > 0) {\r\n                    // Disable direct clicking on tabs when required fields are not valid\r\n                    link.style.pointerEvents = 'none';\r\n                    link.style.opacity = '0.5';\r\n                    link.style.cursor = 'not-allowed';\r\n                }\r\n            });\r\n        }\r\n        // Block tabs if form has changes (only when not pending preload, as pending preload has its own validation)\r\n        else if (hasChanges && !isPendingPreload) {\r\n            tabLinks.forEach(function (link, index) {\r\n                if (index > 0) {\r\n                    // Disable direct clicking on tabs when there are changes\r\n                    link.style.pointerEvents = 'none';\r\n                    link.style.opacity = '0.5';\r\n                    link.style.cursor = 'not-allowed';\r\n                }\r\n            });\r\n        } \r\n        // Re-enable tabs if fields are valid and no changes (or if pending preload and valid)\r\n        else {\r\n            tabLinks.forEach(function (link, index) {\r\n                if (index > 0) {\r\n                    // Only re-enable if not pending preload, or if pending preload and valid\r\n                    if (!isPendingPreload || (isPendingPreload && isValid)) {\r\n                        link.style.pointerEvents = '';\r\n                        link.style.opacity = '';\r\n                        link.style.cursor = '';\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Validate all required fields on initialization\r\n    var requiredInputs = form.querySelectorAll('input[required], select[required]');\r\n    requiredInputs.forEach(function (input) {\r\n        // Validate on initialization\r\n        validateField(input);\r\n\r\n        // For SELECT2 selects, listen to SELECT2 events without interfering\r\n        if (input.tagName === 'SELECT' && typeof $ !== 'undefined' && $(input).data('select2')) {\r\n            $(input).on('select2:select select2:clear', function () {\r\n                // Small delay to ensure SELECT2 has updated the native select value\r\n                var selectElement = this;\r\n                setTimeout(function () {\r\n                    validateField(selectElement);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        // Still update warning alert visibility even if not pending preload\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                }, 10);\r\n            });\r\n        } else {\r\n            // Special handling for CAE/CAI field - validate 14 digits\r\n            if (input.id === 'caecai-edit') {\r\n                // Only allow digits\r\n                input.addEventListener('input', function (e) {\r\n                    // Remove non-digit characters\r\n                    var value = this.value.replace(/\\D/g, '');\r\n                    // Limit to 14 digits\r\n                    if (value.length > 14) {\r\n                        value = value.substring(0, 14);\r\n                    }\r\n                    this.value = value;\r\n                    validateCaecaiField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                input.addEventListener('blur', function () {\r\n                    validateCaecaiField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                // Prevent non-digit characters on keypress\r\n                input.addEventListener('keypress', function (e) {\r\n                    var char = String.fromCharCode(e.which);\r\n                    if (!/[0-9]/.test(char)) {\r\n                        e.preventDefault();\r\n                    }\r\n                });\r\n            }\r\n            // Special handling for Punto de Venta field - validate maximum 5 digits\r\n            else if (input.id === 'punto-venta-edit') {\r\n                // Only allow digits\r\n                input.addEventListener('input', function (e) {\r\n                    // Remove non-digit characters\r\n                    var value = this.value.replace(/\\D/g, '');\r\n                    // Limit to 5 digits\r\n                    if (value.length > 5) {\r\n                        value = value.substring(0, 5);\r\n                    }\r\n                    this.value = value;\r\n                    validatePuntoDeVentaField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                input.addEventListener('blur', function () {\r\n                    validatePuntoDeVentaField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                // Prevent non-digit characters on keypress\r\n                input.addEventListener('keypress', function (e) {\r\n                    var char = String.fromCharCode(e.which);\r\n                    if (!/[0-9]/.test(char)) {\r\n                        e.preventDefault();\r\n                    }\r\n                });\r\n            }\r\n            // Special handling for Número de Comprobante field - validate maximum 8 digits\r\n            else if (input.id === 'numero-comprobante-edit') {\r\n                // Only allow digits\r\n                input.addEventListener('input', function (e) {\r\n                    // Remove non-digit characters\r\n                    var value = this.value.replace(/\\D/g, '');\r\n                    // Limit to 8 digits\r\n                    if (value.length > 8) {\r\n                        value = value.substring(0, 8);\r\n                    }\r\n                    this.value = value;\r\n                    validateNumeroComprobanteField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                input.addEventListener('blur', function () {\r\n                    validateNumeroComprobanteField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                // Prevent non-digit characters on keypress\r\n                input.addEventListener('keypress', function (e) {\r\n                    var char = String.fromCharCode(e.which);\r\n                    if (!/[0-9]/.test(char)) {\r\n                        e.preventDefault();\r\n                    }\r\n                });\r\n            }\r\n            // Special handling for date fields - validate date constraints\r\n            else if (input.id === 'fecha-factura-edit' || input.id === 'venc-caecai-edit') {\r\n                // Date fields are handled by Flatpickr, but we add listeners to the altInput\r\n                setTimeout(function() {\r\n                    var flatpickrInput = input.id === 'fecha-factura-edit' \r\n                        ? document.querySelector('#fecha-factura-edit')\r\n                        : document.querySelector('#venc-caecai-edit');\r\n                    \r\n                    if (flatpickrInput && flatpickrInput._flatpickr && flatpickrInput._flatpickr.altInput) {\r\n                        var altInput = flatpickrInput._flatpickr.altInput;\r\n                        \r\n                        altInput.addEventListener('blur', function () {\r\n                            validateFirstTabFields();\r\n                            updateTabRestrictionsOnChange();\r\n                            if (isPendingPreload) {\r\n                                updateTabsState(wizardElement, isPendingPreload);\r\n                            } else {\r\n                                var isValid = validateFirstTabFields();\r\n                                updateWarningAlertVisibility(isValid);\r\n                            }\r\n                        });\r\n\r\n                        // Listen for changes in fecha-factura to update venc-caecai minDate\r\n                        if (input.id === 'fecha-factura-edit') {\r\n                            flatpickrInput._flatpickr.config.onChange.push(function(selectedDates) {\r\n                                var vencInput = document.querySelector('#venc-caecai-edit');\r\n                                if (vencInput && vencInput._flatpickr && selectedDates.length > 0) {\r\n                                    vencInput._flatpickr.set('minDate', selectedDates[0]);\r\n                                    // Re-validate venc-caecai field\r\n                                    validateFirstTabFields();\r\n                                    updateTabRestrictionsOnChange();\r\n                                    if (isPendingPreload) {\r\n                                        updateTabsState(wizardElement, isPendingPreload);\r\n                                    } else {\r\n                                        var isValid = validateFirstTabFields();\r\n                                        updateWarningAlertVisibility(isValid);\r\n                                    }\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                }, 500);\r\n            }\r\n            // For regular inputs and selects without SELECT2\r\n            else {\r\n                input.addEventListener('blur', function () {\r\n                    validateField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                // Validate on input change\r\n                input.addEventListener('input', function () {\r\n                    validateField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n\r\n                // Validate on change (for selects)\r\n                input.addEventListener('change', function () {\r\n                    validateField(this);\r\n                    updateTabRestrictionsOnChange();\r\n                    if (isPendingPreload) {\r\n                        updateTabsState(wizardElement, isPendingPreload);\r\n                    } else {\r\n                        var isValid = validateFirstTabFields();\r\n                        updateWarningAlertVisibility(isValid);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n    // Also listen for SELECT2 initialization after wizard is created\r\n    // This handles cases where SELECT2 is initialized after the wizard\r\n    setTimeout(function () {\r\n        form.querySelectorAll('select[required]').forEach(function (selectElement) {\r\n            var $select = typeof $ !== 'undefined' ? $(selectElement) : null;\r\n            if ($select && $select.data('select2')) {\r\n                // Only add validation listener, don't interfere with SELECT2's native change event\r\n                $select.on('select2:select select2:clear', function () {\r\n                    // Small delay to ensure SELECT2 has updated the native select value\r\n                    setTimeout(function () {\r\n                        validateField(selectElement);\r\n                        updateTabRestrictionsOnChange();\r\n                        if (isPendingPreload) {\r\n                            updateTabsState(wizardElement, isPendingPreload);\r\n                        } else {\r\n                            var isValid = validateFirstTabFields();\r\n                            updateWarningAlertVisibility(isValid);\r\n                        }\r\n                    }, 10);\r\n                });\r\n            }\r\n        });\r\n    }, 500);\r\n}\r\n\r\n/**\r\n * Shows a validation toast message using DotNet interop\r\n * @param {DotNetObjectReference} dotNetReference - Reference to the C# component\r\n * @param {string} message - The message to display\r\n */\r\nfunction showValidationToast(dotNetReference, message) {\r\n    if (dotNetReference && typeof dotNetReference.invokeMethodAsync === 'function') {\r\n        dotNetReference.invokeMethodAsync('ShowValidationToast', message).catch(function (error) {\r\n            console.error('Error al mostrar toast:', error);\r\n            // Fallback a alert si falla el toast\r\n            alert(message);\r\n        });\r\n    } else {\r\n        // Fallback a alert si no hay referencia DotNet\r\n        alert(message);\r\n    }\r\n}\r\n\r\n/**\r\n * Gets form data for updating document\r\n * @param {HTMLElement} form - The form element\r\n * @returns {Object} Object containing form field values\r\n */\r\nfunction getFormData(form) {\r\n    if (!form) return {};\r\n\r\n    var formData = {};\r\n    var inputs = form.querySelectorAll('input, select, textarea');\r\n\r\n    inputs.forEach(function (input) {\r\n        var fieldId = input.id || input.name;\r\n        if (!fieldId) return;\r\n\r\n        // For SELECT2 selects, get value from SELECT2\r\n        if (input.tagName === 'SELECT' && typeof $ !== 'undefined' && $(input).data('select2')) {\r\n            formData[fieldId] = $(input).val() || '';\r\n        }\r\n        // For Flatpickr date fields, get value from altInput and convert to yyyy-MM-dd format\r\n        else if (input.id === 'fecha-factura-edit' || input.id === 'venc-caecai-edit') {\r\n            if (input._flatpickr && input._flatpickr.selectedDates && input._flatpickr.selectedDates.length > 0) {\r\n                var date = input._flatpickr.selectedDates[0];\r\n                var year = date.getFullYear();\r\n                var month = String(date.getMonth() + 1).padStart(2, '0');\r\n                var day = String(date.getDate()).padStart(2, '0');\r\n                formData[fieldId] = year + '-' + month + '-' + day;\r\n            } else {\r\n                formData[fieldId] = '';\r\n            }\r\n        }\r\n        // For regular inputs\r\n        else {\r\n            formData[fieldId] = input.value || '';\r\n        }\r\n    });\r\n\r\n    // Map field IDs to request parameter names\r\n    var result = {\r\n        docId: 0, // Will be set from document\r\n        sociedadCuit: formData['society-select-edit'] || '',\r\n        tipoDocId: formData['document-type-select-edit'] ? parseInt(formData['document-type-select-edit']) : null,\r\n        puntoDeVenta: formData['punto-venta-edit'] || '',\r\n        numeroComprobante: formData['numero-comprobante-edit'] || '',\r\n        fechaEmisionComprobante: formData['fecha-factura-edit'] || null,\r\n        moneda: formData['currency-select-edit'] || '',\r\n        montoBruto: formData['monto-bruto-edit'] ? parseFloat(formData['monto-bruto-edit']) : null,\r\n        caecai: formData['caecai-edit'] || '',\r\n        vencimientoCaecai: formData['venc-caecai-edit'] || null\r\n    };\r\n\r\n    return result;\r\n}\r\n\r\n/**\r\n * Stores the initial state of form fields for change detection\r\n * @param {HTMLElement} form - The form element\r\n * @returns {Object} Object containing initial field values\r\n */\r\nfunction saveInitialFormState(form) {\r\n    if (!form) return {};\r\n\r\n    var initialState = {};\r\n    var inputs = form.querySelectorAll('input, select, textarea');\r\n\r\n    inputs.forEach(function (input) {\r\n        var fieldId = input.id || input.name;\r\n        if (!fieldId) return;\r\n\r\n        // For SELECT2 selects, get value from SELECT2\r\n        if (input.tagName === 'SELECT' && typeof $ !== 'undefined' && $(input).data('select2')) {\r\n            initialState[fieldId] = $(input).val() || '';\r\n        }\r\n        // For Flatpickr date fields, get value from altInput\r\n        else if (input.id === 'fecha-factura-edit' || input.id === 'venc-caecai-edit') {\r\n            if (input._flatpickr && input._flatpickr.altInput) {\r\n                initialState[fieldId] = input._flatpickr.altInput.value || '';\r\n            } else {\r\n                initialState[fieldId] = input.value || '';\r\n            }\r\n        }\r\n        // For regular inputs\r\n        else {\r\n            initialState[fieldId] = input.value || '';\r\n        }\r\n    });\r\n\r\n    return initialState;\r\n}\r\n\r\n/**\r\n * Detects if any form field has changed compared to initial state\r\n * @param {HTMLElement} form - The form element\r\n * @param {Object} initialState - The initial state of fields\r\n * @returns {boolean} True if any field has changed, false otherwise\r\n */\r\nfunction hasFormChanged(form, initialState) {\r\n    if (!form || !initialState) return false;\r\n\r\n    var inputs = form.querySelectorAll('input, select, textarea');\r\n\r\n    for (var i = 0; i < inputs.length; i++) {\r\n        var input = inputs[i];\r\n        var fieldId = input.id || input.name;\r\n        if (!fieldId || !initialState.hasOwnProperty(fieldId)) continue;\r\n\r\n        var currentValue = '';\r\n        var initialValue = initialState[fieldId] || '';\r\n\r\n        // For SELECT2 selects, get value from SELECT2\r\n        if (input.tagName === 'SELECT' && typeof $ !== 'undefined' && $(input).data('select2')) {\r\n            currentValue = $(input).val() || '';\r\n        }\r\n        // For Flatpickr date fields, get value from altInput\r\n        else if (input.id === 'fecha-factura-edit' || input.id === 'venc-caecai-edit') {\r\n            if (input._flatpickr && input._flatpickr.altInput) {\r\n                currentValue = input._flatpickr.altInput.value || '';\r\n            } else {\r\n                currentValue = input.value || '';\r\n            }\r\n        }\r\n        // For regular inputs\r\n        else {\r\n            currentValue = input.value || '';\r\n        }\r\n\r\n        // Compare values (normalize empty strings and null/undefined)\r\n        var normalizedCurrent = (currentValue || '').toString().trim();\r\n        var normalizedInitial = (initialValue || '').toString().trim();\r\n\r\n        if (normalizedCurrent !== normalizedInitial) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * Sets up navigation restrictions for \"Pendiente Precarga\" status and when form has changes\r\n * @param {HTMLElement} wizardElement - The wizard container element\r\n * @param {boolean} isPendingPreload - Whether the document is in \"Pendiente Precarga\" status\r\n * @param {DotNetObjectReference} dotNetReference - Reference to the C# component for showing toast\r\n * @param {Function} getInitialState - Function that returns the initial state of form fields for change detection\r\n * @param {Function} updateInitialState - Function to update the initial state\r\n */\r\nfunction setupNavigationRestrictions(wizardElement, isPendingPreload, dotNetReference, getInitialState, updateInitialState) {\r\n    var validationMessage = 'Por favor debe completar todos los campos requeridos del documento para poder avanzar.';\r\n    var changeMessage = 'Debe usar el botón \"Siguiente\" para avanzar cuando hay cambios en los campos.';\r\n\r\n    // Initially disable tabs after the first one and update warning alert visibility\r\n    if (isPendingPreload) {\r\n        updateTabsState(wizardElement, isPendingPreload);\r\n    }\r\n    \r\n    // Also check initial state for warning alert (in case not pending preload)\r\n    if (!isPendingPreload) {\r\n        var isValid = validateFirstTabFields();\r\n        updateWarningAlertVisibility(isValid);\r\n    }\r\n\r\n    // Function to check if navigation should be blocked\r\n    function shouldBlockNavigation() {\r\n        var form = document.getElementById('documentPropertiesForm');\r\n        if (!form) return false;\r\n\r\n        // Block if pending preload and fields are not valid\r\n        if (isPendingPreload && !validateFirstTabFields()) {\r\n            return true;\r\n        }\r\n\r\n        // Block if form has changes (only for tabs after the first one)\r\n        var initialState = getInitialState ? getInitialState() : null;\r\n        if (initialState && hasFormChanged(form, initialState)) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // Flag to track if navigation is coming from \"Siguiente\" button\r\n    var isNavigatingFromNextButton = false;\r\n\r\n    // Prevent navigation to other tabs when clicking on disabled tabs or when form has changes\r\n    var tabLinks = wizardElement.querySelectorAll('.nav-link');\r\n    tabLinks.forEach(function (link, index) {\r\n        if (index > 0) {\r\n            // Use capture phase to intercept before Bootstrap handles it\r\n            link.addEventListener('click', function (e) {\r\n                var form = document.getElementById('documentPropertiesForm');\r\n                if (!form) return;\r\n\r\n                // Always block if required fields are not valid (regardless of status)\r\n                if (!validateFirstTabFields()) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    e.stopImmediatePropagation();\r\n                    showValidationToast(dotNetReference, validationMessage);\r\n                    return false;\r\n                }\r\n\r\n                // Block navigation if form has changes (only when clicking on tab titles, not from \"Siguiente\" button)\r\n                if (!isNavigatingFromNextButton) {\r\n                    var initialState = getInitialState ? getInitialState() : null;\r\n                    if (initialState && hasFormChanged(form, initialState)) {\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                        e.stopImmediatePropagation();\r\n                        showValidationToast(dotNetReference, changeMessage);\r\n                        return false;\r\n                    }\r\n                }\r\n            }, true);\r\n\r\n            // Also intercept Bootstrap tab events\r\n            link.addEventListener('show.bs.tab', function (e) {\r\n                var form = document.getElementById('documentPropertiesForm');\r\n                if (!form) return;\r\n\r\n                // Always block if required fields are not valid (regardless of status)\r\n                if (!validateFirstTabFields()) {\r\n                    e.preventDefault();\r\n                    showValidationToast(dotNetReference, validationMessage);\r\n                    return false;\r\n                }\r\n\r\n                // Block navigation if form has changes (only when clicking on tab titles, not from \"Siguiente\" button)\r\n                if (!isNavigatingFromNextButton) {\r\n                    var initialState = getInitialState ? getInitialState() : null;\r\n                    if (initialState && hasFormChanged(form, initialState)) {\r\n                        e.preventDefault();\r\n                        showValidationToast(dotNetReference, changeMessage);\r\n                        return false;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    // Intercept wizard navigation buttons\r\n    var nextButton = wizardElement.querySelector('.next a');\r\n    if (nextButton) {\r\n        // Use capture phase to intercept before wizard handles it\r\n        nextButton.addEventListener('click', async function (e) {\r\n            var activeTab = wizardElement.querySelector('.nav-link.active');\r\n            var activeTabHref = activeTab ? activeTab.getAttribute('href') : null;\r\n            var form = document.getElementById('documentPropertiesForm');\r\n            if (!form) return;\r\n\r\n            // Only check for changes and validate when on the first tab (properties)\r\n            if (activeTabHref === '#document-properties-step') {\r\n                // Always validate required fields before allowing navigation\r\n                if (!validateFirstTabFields()) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    e.stopImmediatePropagation();\r\n                    showValidationToast(dotNetReference, validationMessage);\r\n                    return false;\r\n                }\r\n\r\n                // Check if form has changes\r\n                var initialState = getInitialState ? getInitialState() : null;\r\n                var hasChanges = initialState ? hasFormChanged(form, initialState) : false;\r\n\r\n                if (hasChanges) {\r\n                    // Prevent default navigation\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    e.stopImmediatePropagation();\r\n\r\n                    // Show confirmation dialog using C# component\r\n                    var confirmed = false;\r\n                    if (dotNetReference && typeof dotNetReference.invokeMethodAsync === 'function') {\r\n                        try {\r\n                            confirmed = await dotNetReference.invokeMethodAsync('ShowConfirmationDialog',\r\n                                'Ha realizado cambios en los campos del documento. ¿Desea guardar estos cambios antes de continuar?\\n\\nPresione \"Aceptar\" para guardar y continuar, o \"Cancelar\" para permanecer en esta pestaña.');\r\n                        } catch (error) {\r\n                            console.error('Error al mostrar diálogo de confirmación:', error);\r\n                            // Fallback a confirm nativo si falla\r\n                            confirmed = confirm('Ha realizado cambios en los campos del documento. ¿Desea guardar estos cambios antes de continuar?\\n\\nPresione \"Aceptar\" para guardar y continuar, o \"Cancelar\" para permanecer en esta pestaña.');\r\n                        }\r\n                    } else {\r\n                        // Fallback a confirm nativo si no hay referencia DotNet\r\n                        confirmed = confirm('Ha realizado cambios en los campos del documento. ¿Desea guardar estos cambios antes de continuar?\\n\\nPresione \"Aceptar\" para guardar y continuar, o \"Cancelar\" para permanecer en esta pestaña.');\r\n                    }\r\n\r\n                    if (confirmed) {\r\n                        // User confirmed - update document\r\n                        try {\r\n                            // Get form values\r\n                            var formData = getFormData(form);\r\n                            \r\n                            // Get docId from wizard element data attribute or from C# method\r\n                            var docId = wizardElement.getAttribute('data-doc-id') ? \r\n                                parseInt(wizardElement.getAttribute('data-doc-id')) : 0;\r\n                            \r\n                            if (!docId) {\r\n                                showValidationToast(dotNetReference, 'Error: No se pudo obtener el ID del documento.');\r\n                                return false;\r\n                            }\r\n                            \r\n                            // Call C# method to update document\r\n                            if (dotNetReference && typeof dotNetReference.invokeMethodAsync === 'function') {\r\n                                var result = await dotNetReference.invokeMethodAsync('UpdateDocumentFromWizard',\r\n                                    docId,\r\n                                    formData.sociedadCuit,\r\n                                    formData.tipoDocId,\r\n                                    formData.puntoDeVenta,\r\n                                    formData.numeroComprobante,\r\n                                    formData.fechaEmisionComprobante,\r\n                                    formData.moneda,\r\n                                    formData.montoBruto,\r\n                                    formData.caecai,\r\n                                    formData.vencimientoCaecai);\r\n\r\n                                if (result && result.success) {\r\n                                    // Update successful - update initial state and allow navigation\r\n                                    // Wait a bit for form to update from C# (StateHasChanged)\r\n                                    setTimeout(function() {\r\n                                        // Save new initial state after update\r\n                                        // Wait for DOM to update with new values from C#\r\n                                        setTimeout(function() {\r\n                                            var updatedState = saveInitialFormState(form);\r\n                                            \r\n                                            // Update the initial state using the update function\r\n                                            if (updateInitialState) {\r\n                                                updateInitialState(updatedState);\r\n                                            }\r\n\r\n                                            // Show success message\r\n                                            showValidationToast(dotNetReference, result.message || 'Documento actualizado exitosamente.');\r\n\r\n                                            // Set flag to allow navigation\r\n                                            isNavigatingFromNextButton = true;\r\n                                            \r\n                                            // Trigger wizard navigation programmatically\r\n                                            setTimeout(function() {\r\n                                                // Find next tab and activate it\r\n                                                var currentTabIndex = Array.from(wizardElement.querySelectorAll('.nav-link')).indexOf(activeTab);\r\n                                                var nextTabLink = wizardElement.querySelectorAll('.nav-link')[currentTabIndex + 1];\r\n                                                if (nextTabLink) {\r\n                                                    // Use Bootstrap tab API to switch\r\n                                                    var nextTab = new bootstrap.Tab(nextTabLink);\r\n                                                    nextTab.show();\r\n                                                }\r\n                                                \r\n                                                // Reset flag after navigation completes\r\n                                                setTimeout(function() {\r\n                                                    isNavigatingFromNextButton = false;\r\n                                                }, 200);\r\n                                            }, 100);\r\n                                        }, 500); // Wait for C# StateHasChanged to update DOM\r\n                                    }, 100);\r\n                                } else {\r\n                                    // Update failed - show error and prevent navigation\r\n                                    showValidationToast(dotNetReference, result.message || 'Error al actualizar el documento. No se pudo avanzar.');\r\n                                }\r\n                            } else {\r\n                                showValidationToast(dotNetReference, 'Error: No se pudo comunicar con el servidor para actualizar el documento.');\r\n                            }\r\n                        } catch (error) {\r\n                            console.error('Error al actualizar documento:', error);\r\n                            showValidationToast(dotNetReference, 'Error al actualizar el documento: ' + (error.message || 'Error desconocido'));\r\n                        }\r\n                    }\r\n                    // If user cancelled, do nothing (stay on current tab)\r\n                    return false;\r\n                } else {\r\n                    // No changes - allow normal navigation\r\n                    isNavigatingFromNextButton = true;\r\n                    \r\n                    // Reset flag after a short delay to allow the tab change to complete\r\n                    setTimeout(function() {\r\n                        isNavigatingFromNextButton = false;\r\n                    }, 100);\r\n                }\r\n            } else {\r\n                // Not on first tab - allow normal navigation without checking for changes\r\n                isNavigatingFromNextButton = true;\r\n                \r\n                // Reset flag after a short delay to allow the tab change to complete\r\n                setTimeout(function() {\r\n                    isNavigatingFromNextButton = false;\r\n                }, 100);\r\n            }\r\n        }, true);\r\n    }\r\n\r\n    // Intercept Bootstrap tab show event globally for this wizard\r\n    wizardElement.addEventListener('show.bs.tab', function (e) {\r\n        var form = document.getElementById('documentPropertiesForm');\r\n        if (!form) return;\r\n\r\n        var targetTab = e.target;\r\n        var targetHref = targetTab.getAttribute('href');\r\n\r\n        // If trying to navigate away from first tab\r\n        if (targetHref !== '#document-properties-step') {\r\n            // Always block if required fields are not valid (regardless of status)\r\n            if (!validateFirstTabFields()) {\r\n                e.preventDefault();\r\n                showValidationToast(dotNetReference, validationMessage);\r\n                return false;\r\n            }\r\n\r\n            // Block navigation if form has changes (only when clicking on tab titles, not from \"Siguiente\" button)\r\n            if (!isNavigatingFromNextButton) {\r\n                var initialState = getInitialState ? getInitialState() : null;\r\n                if (initialState && hasFormChanged(form, initialState)) {\r\n                    e.preventDefault();\r\n                    showValidationToast(dotNetReference, changeMessage);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Initializes the edit document wizard with validation\r\n * @param {boolean} isPendingPreload - Whether the document is in \"Pendiente Precarga\" status\r\n * @param {DotNetObjectReference} dotNetReference - Reference to the C# component for showing toast\r\n * @param {number} docId - The document ID\r\n */\r\nwindow.initEditDocumentWizard = function (isPendingPreload, dotNetReference, docId) {\r\n    // Store initial state in a variable accessible to all functions\r\n    // Use an object to allow updating the reference\r\n    var initialStateContainer = { value: null };\r\n    \r\n    // Function to update the initial state (accessible from nested functions)\r\n    var updateInitialState = function(newState) {\r\n        initialStateContainer.value = newState;\r\n    };\r\n\r\n    function initWizard() {\r\n        var wizardElement = document.getElementById('edit-document-wizard');\r\n        if (!wizardElement) {\r\n            console.warn('Wizard element not found');\r\n            return false;\r\n        }\r\n\r\n        // Check if Wizard class is available\r\n        if (typeof Wizard === 'undefined') {\r\n            console.warn('Wizard class not found, retrying...');\r\n            return false;\r\n        }\r\n\r\n        try {\r\n            // Store docId in wizard element for later use\r\n            if (docId) {\r\n                wizardElement.setAttribute('data-doc-id', docId.toString());\r\n            }\r\n\r\n            // Create new wizard instance with validation\r\n            var wizard = new Wizard('#edit-document-wizard', {\r\n                validate: true\r\n            });\r\n\r\n            // Get form element\r\n            var form = document.getElementById('documentPropertiesForm');\r\n\r\n            // Set up navigation restrictions (initialState will be set later)\r\n            // Pass both getter and setter functions\r\n            setupNavigationRestrictions(wizardElement, isPendingPreload, dotNetReference, \r\n                function() {\r\n                    return initialStateContainer.value;\r\n                },\r\n                updateInitialState\r\n            );\r\n\r\n            // Set up form validation (initialState will be set later)\r\n            if (form) {\r\n                setupFormValidation(form, isPendingPreload, wizardElement, function() {\r\n                    return initialStateContainer.value;\r\n                });\r\n            }\r\n\r\n            // Initial validation and tabs state update after a delay to ensure SELECT2 and Flatpickr are initialized\r\n            setTimeout(function () {\r\n                // Save initial state now that SELECT2 and Flatpickr are initialized\r\n                if (form) {\r\n                    initialStateContainer.value = saveInitialFormState(form);\r\n                    \r\n                    // Update tab restrictions based on initial validation state\r\n                    // This will block tabs if required fields are not complete\r\n                    var isValid = validateFirstTabFields();\r\n                    var tabLinks = wizardElement.querySelectorAll('.nav-link');\r\n                    \r\n                    // Block tabs if required fields are not valid (regardless of status)\r\n                    if (!isValid) {\r\n                        tabLinks.forEach(function (link, index) {\r\n                            if (index > 0) {\r\n                                link.style.pointerEvents = 'none';\r\n                                link.style.opacity = '0.5';\r\n                                link.style.cursor = 'not-allowed';\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n\r\n                if (isPendingPreload) {\r\n                    updateTabsState(wizardElement, isPendingPreload);\r\n                } else {\r\n                    // Check initial state for warning alert visibility even if not pending preload\r\n                    var isValid = validateFirstTabFields();\r\n                    updateWarningAlertVisibility(isValid);\r\n                }\r\n                // Update save button visibility on initialization\r\n                updateSaveButtonVisibility(wizardElement);\r\n            }, 800);\r\n\r\n            // Set up event listener to update save button visibility when tab changes\r\n            setupSaveButtonVisibility(wizardElement);\r\n\r\n            console.log('Edit document wizard initialized successfully');\r\n            return true;\r\n        } catch (e) {\r\n            console.error('Error initializing wizard:', e);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Try to initialize immediately\r\n    if (!initWizard()) {\r\n        // If Wizard class is not available, wait a bit and try again\r\n        var attempts = 0;\r\n        var maxAttempts = 10;\r\n        var interval = setInterval(function () {\r\n            attempts++;\r\n            if (initWizard() || attempts >= maxAttempts) {\r\n                clearInterval(interval);\r\n                if (attempts >= maxAttempts && typeof Wizard === 'undefined') {\r\n                    console.error('Wizard class not found after multiple attempts');\r\n                }\r\n            }\r\n        }, 100);\r\n    }\r\n};\r\n\r\n/**\r\n * Updates the visibility of the save button based on the current active tab\r\n * @param {HTMLElement} wizardElement - The wizard container element\r\n */\r\nfunction updateSaveButtonVisibility(wizardElement) {\r\n    if (!wizardElement) return;\r\n\r\n    var saveButtonContainer = wizardElement.querySelector('.wizard .last');\r\n    if (!saveButtonContainer) return;\r\n\r\n    // Get the active tab\r\n    var activeTab = wizardElement.querySelector('.nav-link.active');\r\n    if (!activeTab) {\r\n        // Hide save button if no active tab\r\n        saveButtonContainer.style.display = 'none';\r\n        return;\r\n    }\r\n\r\n    var activeTabHref = activeTab.getAttribute('href');\r\n    \r\n    // Show save button only on the last step (notes-step)\r\n    if (activeTabHref === '#notes-step') {\r\n        saveButtonContainer.style.display = '';\r\n    } else {\r\n        saveButtonContainer.style.display = 'none';\r\n    }\r\n}\r\n\r\n/**\r\n * Sets up event listeners to update save button visibility when tabs change\r\n * @param {HTMLElement} wizardElement - The wizard container element\r\n */\r\nfunction setupSaveButtonVisibility(wizardElement) {\r\n    if (!wizardElement) return;\r\n\r\n    // Listen for Bootstrap tab show events\r\n    wizardElement.addEventListener('shown.bs.tab', function (e) {\r\n        updateSaveButtonVisibility(wizardElement);\r\n    });\r\n\r\n    // Also listen for tab click events as fallback\r\n    var tabLinks = wizardElement.querySelectorAll('.nav-link');\r\n    tabLinks.forEach(function (link) {\r\n        link.addEventListener('click', function () {\r\n            // Use setTimeout to ensure the tab has changed before updating visibility\r\n            setTimeout(function () {\r\n                updateSaveButtonVisibility(wizardElement);\r\n            }, 100);\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Resets the wizard to the first step\r\n */\r\nwindow.resetEditDocumentWizard = function () {\r\n    var wizardElement = document.getElementById('edit-document-wizard');\r\n    if (wizardElement) {\r\n        var firstTab = wizardElement.querySelector('.nav-link');\r\n        if (firstTab) {\r\n            var firstTabPane = document.querySelector(firstTab.getAttribute('href'));\r\n            if (firstTabPane) {\r\n                // Reset all tabs\r\n                wizardElement.querySelectorAll('.nav-link').forEach(function (link) {\r\n                    link.classList.remove('active');\r\n                });\r\n                wizardElement.querySelectorAll('.tab-pane').forEach(function (pane) {\r\n                    pane.classList.remove('show', 'active');\r\n                });\r\n                // Activate first tab\r\n                firstTab.classList.add('active');\r\n                firstTabPane.classList.add('show', 'active');\r\n                \r\n                // Update save button visibility after reset\r\n                updateSaveButtonVisibility(wizardElement);\r\n            }\r\n        }\r\n    }\r\n};\r\n"]}