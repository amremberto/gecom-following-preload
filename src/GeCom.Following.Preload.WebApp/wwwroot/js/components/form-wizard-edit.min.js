function validateFirstTabFields(){var e=document.getElementById("documentPropertiesForm");if(!e)return!1;var t=!0;return e.querySelectorAll("input[required], select[required]").forEach(function(e){if(null!==e.offsetParent&&!e.disabled)if("SELECT"===e.tagName&&"undefined"!=typeof $&&$(e).data("select2")){(i=$(e).val())&&""!==i&&null!==i?(e.classList.remove("is-invalid"),e.classList.add("is-valid")):(t=!1,e.classList.add("is-invalid"),e.classList.remove("is-valid"))}else{var i=e.value;if("caecai-edit"===e.id){var a=i.replace(/\D/g,"");i&&""!==i.trim()&&14===a.length?(e.classList.remove("is-invalid"),e.classList.add("is-valid")):(t=!1,e.classList.add("is-invalid"),e.classList.remove("is-valid"),e.nextElementSibling&&e.nextElementSibling.classList.contains("invalid-feedback")&&(e.nextElementSibling.textContent="El nro. CAE/CAI debe tener exactamente 14 dígitos."))}else if("fecha-factura-edit"===e.id||"venc-caecai-edit"===e.id){var s="fecha-factura-edit"===e.id?document.querySelector("#fecha-factura-edit"):document.querySelector("#venc-caecai-edit");if(s&&s._flatpickr){var l=s._flatpickr.altInput;if(l){var n=l.value;if(n&&""!==n.trim()){var r=!0;if("fecha-factura-edit"===e.id&&s._flatpickr.selectedDates.length>0){var d=s._flatpickr.selectedDates[0],o=new Date;o.setHours(0,0,0,0),d.setHours(0,0,0,0),d>o?(r=!1,l.setCustomValidity("La fecha de factura no puede ser mayor al día actual.")):l.setCustomValidity("")}if("venc-caecai-edit"===e.id){var c=document.querySelector("#fecha-factura-edit");if(c&&c._flatpickr&&c._flatpickr.selectedDates.length>0){d=c._flatpickr.selectedDates[0];if(s._flatpickr.selectedDates.length>0){var u=s._flatpickr.selectedDates[0];d.setHours(0,0,0,0),u.setHours(0,0,0,0),u<d?(r=!1,l.setCustomValidity("La fecha Venc. CAE/CAI no puede ser anterior a la fecha de factura.")):l.setCustomValidity("")}}}!r||l.classList.contains("is-invalid")?(t=!1,l.classList.add("is-invalid"),l.classList.remove("is-valid")):(l.classList.remove("is-invalid"),l.classList.add("is-valid"))}else t=!1,l.classList.add("is-invalid"),l.classList.remove("is-valid")}}else i&&""!==i.trim()?(e.classList.remove("is-invalid"),e.classList.add("is-valid")):(t=!1,e.classList.add("is-invalid"),e.classList.remove("is-valid"))}else"number"===e.type?!i||""===i||parseFloat(i)<=0?(t=!1,e.classList.add("is-invalid"),e.classList.remove("is-valid")):(e.classList.remove("is-invalid"),e.classList.add("is-valid")):i&&""!==i.trim()?(e.classList.remove("is-invalid"),e.classList.add("is-valid")):(t=!1,e.classList.add("is-invalid"),e.classList.remove("is-valid"))}}),t}function updateTabsState(e,t){if(t){for(var i=validateFirstTabFields(),a=e.querySelectorAll(".nav-link"),s=1;s<a.length;s++)i?(a[s].classList.remove("disabled"),a[s].style.pointerEvents="",a[s].style.opacity="",a[s].style.cursor=""):(a[s].classList.add("disabled"),a[s].style.pointerEvents="none",a[s].style.opacity="0.5",a[s].style.cursor="not-allowed");updateWarningAlertVisibility(i)}}function updateWarningAlertVisibility(e){var t=document.getElementById("first-tab-warning-alert");t&&(t.style.display=e?"none":"block")}function validateCaecaiField(e){if(!e||"caecai-edit"!==e.id)return!0;var t=e.value||"",i=t.replace(/\D/g,"");if(!t||""===t.trim())return e.hasAttribute("required")?(e.setCustomValidity("Por favor ingrese el número de CAE / CAI."),e.classList.add("is-invalid"),e.classList.remove("is-valid"),!1):(e.setCustomValidity(""),e.classList.remove("is-invalid"),e.classList.remove("is-valid"),!0);if(14!==i.length){e.setCustomValidity("El nro. CAE/CAI debe tener exactamente 14 dígitos."),e.classList.add("is-invalid"),e.classList.remove("is-valid");var a=e.nextElementSibling;return a&&a.classList.contains("invalid-feedback")&&(a.textContent="El nro. CAE/CAI debe tener exactamente 14 dígitos."),!1}return e.setCustomValidity(""),e.classList.remove("is-invalid"),e.classList.add("is-valid"),!0}function validateField(e){if(e.hasAttribute("required")){if("text"===e.type||"number"===e.type)return e.value&&""!==e.value.trim()?(e.setCustomValidity(""),e.classList.remove("is-invalid"),e.checkValidity()&&e.classList.add("is-valid"),!0):(e.setCustomValidity("Este campo es obligatorio"),e.classList.add("is-invalid"),e.classList.remove("is-valid"),!1);if("SELECT"===e.tagName)return e.value&&""!==e.value?(e.setCustomValidity(""),e.classList.remove("is-invalid"),e.classList.add("is-valid"),!0):(e.setCustomValidity("Por favor seleccione una opción"),e.classList.add("is-invalid"),e.classList.remove("is-valid"),!1)}return!0}function setupFormValidation(e,t,i){e&&(e.querySelectorAll("input[required], select[required]").forEach(function(e){validateField(e),"SELECT"===e.tagName&&"undefined"!=typeof $&&$(e).data("select2")?$(e).on("select2:select select2:clear",function(){var e=this;setTimeout(function(){(validateField(e),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())},10)}):"caecai-edit"===e.id?(e.addEventListener("input",function(e){var a=this.value.replace(/\D/g,"");(a.length>14&&(a=a.substring(0,14)),this.value=a,validateCaecaiField(this),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())}),e.addEventListener("blur",function(){(validateCaecaiField(this),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())}),e.addEventListener("keypress",function(e){var t=String.fromCharCode(e.which);/[0-9]/.test(t)||e.preventDefault()})):"fecha-factura-edit"===e.id||"venc-caecai-edit"===e.id?setTimeout(function(){var a="fecha-factura-edit"===e.id?document.querySelector("#fecha-factura-edit"):document.querySelector("#venc-caecai-edit");a&&a._flatpickr&&a._flatpickr.altInput&&(a._flatpickr.altInput.addEventListener("blur",function(){(validateFirstTabFields(),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())}),"fecha-factura-edit"===e.id&&a._flatpickr.config.onChange.push(function(e){var a=document.querySelector("#venc-caecai-edit");a&&a._flatpickr&&e.length>0&&(a._flatpickr.set("minDate",e[0]),validateFirstTabFields(),t?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields()))}))},500):(e.addEventListener("blur",function(){(validateField(this),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())}),e.addEventListener("input",function(){(validateField(this),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())}),e.addEventListener("change",function(){(validateField(this),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())}))}),setTimeout(function(){e.querySelectorAll("select[required]").forEach(function(e){var a="undefined"!=typeof $?$(e):null;a&&a.data("select2")&&a.on("select2:select select2:clear",function(){setTimeout(function(){(validateField(e),t)?updateTabsState(i,t):updateWarningAlertVisibility(validateFirstTabFields())},10)})})},500))}function showValidationToast(e,t){e&&"function"==typeof e.invokeMethodAsync?e.invokeMethodAsync("ShowValidationToast",t).catch(function(e){console.error("Error al mostrar toast:",e),alert(t)}):alert(t)}function setupNavigationRestrictions(e,t,i){if(t){var a="Por favor debe completar todos los campos requeridos del documento para poder avanzar.";if(updateTabsState(e,t),!t)updateWarningAlertVisibility(validateFirstTabFields());e.querySelectorAll(".nav-link").forEach(function(e,s){s>0&&(e.addEventListener("click",function(e){if(t&&!validateFirstTabFields())return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),showValidationToast(i,a),!1},!0),e.addEventListener("show.bs.tab",function(e){if(t&&!validateFirstTabFields())return e.preventDefault(),showValidationToast(i,a),!1}))});var s=e.querySelector(".next a");s&&s.addEventListener("click",function(t){var s=e.querySelector(".nav-link.active");if(s&&"#document-properties-step"===s.getAttribute("href")&&!validateFirstTabFields())return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),showValidationToast(i,a),!1},!0),e.addEventListener("show.bs.tab",function(e){if(t&&("#document-properties-step"!==e.target.getAttribute("href")&&!validateFirstTabFields()))return e.preventDefault(),showValidationToast(i,a),!1})}}function updateSaveButtonVisibility(e){if(e){var t=e.querySelector(".wizard .last");if(t){var i=e.querySelector(".nav-link.active");if(i){var a=i.getAttribute("href");t.style.display="#notes-step"===a?"":"none"}else t.style.display="none"}}}function setupSaveButtonVisibility(e){e&&(e.addEventListener("shown.bs.tab",function(t){updateSaveButtonVisibility(e)}),e.querySelectorAll(".nav-link").forEach(function(t){t.addEventListener("click",function(){setTimeout(function(){updateSaveButtonVisibility(e)},100)})}))}window.initEditDocumentWizard=function(e,t){function i(){var i=document.getElementById("edit-document-wizard");if(!i)return console.warn("Wizard element not found"),!1;if("undefined"==typeof Wizard)return console.warn("Wizard class not found, retrying..."),!1;try{new Wizard("#edit-document-wizard",{validate:!0});setupNavigationRestrictions(i,e,t);var a=document.getElementById("documentPropertiesForm");return a&&setupFormValidation(a,e,i),setTimeout(function(){e?updateTabsState(i,e):updateWarningAlertVisibility(validateFirstTabFields());updateSaveButtonVisibility(i)},600),setupSaveButtonVisibility(i),console.log("Edit document wizard initialized successfully"),!0}catch(e){return console.error("Error initializing wizard:",e),!1}}if(!i())var a=0,s=setInterval(function(){a++,(i()||a>=10)&&(clearInterval(s),a>=10&&"undefined"==typeof Wizard&&console.error("Wizard class not found after multiple attempts"))},100)},window.resetEditDocumentWizard=function(){var e=document.getElementById("edit-document-wizard");if(e){var t=e.querySelector(".nav-link");if(t){var i=document.querySelector(t.getAttribute("href"));i&&(e.querySelectorAll(".nav-link").forEach(function(e){e.classList.remove("active")}),e.querySelectorAll(".tab-pane").forEach(function(e){e.classList.remove("show","active")}),t.classList.add("active"),i.classList.add("show","active"),updateSaveButtonVisibility(e))}}};
//# sourceMappingURL=form-wizard-edit.min.js.map
